# 設計ノート
このノートは当該機器の電子回路設計の履歴や設計意図を記録しています。</br>
回路動作の理解や改善・修理などにご利用ください

## 修正履歴
- 初版：2024/12/1  名前

## 設計の概要
### マーカコイルドライバ本体
マーカコイルドライバはMEGのセンサ近くで動作させるため、本体から輻射する電磁ノイズ、シールドルーム外から導入してくる電磁ノイズを厳しくコントロールする必要があります。</br>
そのため、マーカコイルドライバ本体は電源として充電池を採用し、さらに外部機器（MEGデータ収録装置）との接続を光ファイバを用いて電気的に絶縁することで必要十分な低ノイズを実現しています。

#### 設計のポイント
1. 電磁ノイズの低減
    電源に充電池を使用しました。外部（交流電源）から生成した電源を使用しないことで、ノイズの流入を防ぎます。
    その代償として、回路の動作電圧が5V程度に制限されてしまいますが、ドライブする電流が少ないこと、プッシュプル回路で等価的に2倍のドライブ電圧にすることで、欠点を補っています。
    外部との接続にはプラスティックファイバ用のトランシーバを利用しています。このトランシーバは通常10Mbps程度の高速データ通信を行うために設計されており、高電流（数十ｍA）で送信側をドライブするよう最適化されていますが、マーカコイルドライバの設計では伝送レートが非常に低いことと駆動電流により発生する磁気ノイズを低減するために極端に低い駆動電流になるよう設計しています。

2. プッシュプル回路によるコイルのドライブ
    電源電圧が5V以下と低い（実際には3.3Vでの動作）となっていますが、安定したコイル駆動のためにはできるだけ高いドライブ電圧を稼ぐ必要があります。低電圧電源の欠点を回避するため、コイルの両端を逆位相の電圧で駆動する「プッシュプル」構成のドライブ回路としました。これにより等価的に2倍の電圧でコイルを駆動することができます。
    また、回路のGND電位をコイルに導入しない構成のため、MEGのセンサの近傍には比較的高インピーダンスの信号線が近づくことになり、ドライブ回路のコモンモード電圧に高周波ノイズが発生したとしても、センサ側に影響を与えにくいと考えています。
    （そもそも電池で駆動しているドライブ回路のコモンモード電圧は発生しないと考えられますが、ドライバの筐体が他の機器のGNDに接触してしまうなど、利用状況によって発生する可能性も無視できません）
3. 

   
#### デバイス仕様・定数の決定